window.Wized=window.Wized||[],window.Wized.push(async e=>{await e.requests.waitFor("lesson_details_get");let t=document.getElementById("vimeo-player"),a=new Vimeo.Player(t),l=0,s=null,n=e.data.v.lessonCompleted,i=await a.getDuration();async function o(t){n||(e.data.v.watchedTill=1e3*t,await e.requests.execute("lesson_progress_update"))}function u(e){null!==s||n||(s=setInterval(async()=>{let e=await a.getCurrentTime();e>l&&(await o(e),l=e)},2e3))}function r(){null!==s&&(clearInterval(s),s=null)}n||(e.data.v.videoTotalDuration=1e3*i),a.on("play",async()=>{let t=await a.getCurrentTime();if(n){let l=e.data.v.lastSavedPlaybackPosition||0;e.data.v.watchedTill=l,await e.requests.execute("lesson_progress_update")}else u(t)}),a.on("pause",r),a.on("seeked",async()=>{let e=await a.getCurrentTime();n||u(e)}),a.on("ended",async()=>{if(!n){let t=await a.getDuration();e.data.v.watchedTill=1e3*t,await e.requests.execute("lesson_progress_update"),e.data.v.lessonCompleted=!0,await e.requests.execute("lesson_details_get")}if(r(),"true"===localStorage.getItem("autoplay")){let l=document.querySelector('[wized="lesson_nextChapter_link"]');l?l.click():console.error("Next chapter link not found")}});let d=document.getElementById("autoplayToggle");d.addEventListener("click",()=>{let e="true"===localStorage.getItem("autoplay");localStorage.setItem("autoplay",(!e).toString()),e?a.pause():a.play()});let c=await a.getCurrentTime();c>0&&!n&&(l=c,o(c),u(c))});
